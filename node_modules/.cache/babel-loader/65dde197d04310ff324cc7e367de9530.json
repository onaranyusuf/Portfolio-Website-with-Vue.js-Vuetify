{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n// Locales\nimport en from \"../locale/en.mjs\"; // Composables\n\nimport { createRtl, RtlSymbol } from \"./rtl.mjs\"; // Utilities\n\nimport { computed, inject, provide, ref } from 'vue';\nimport { consoleError, consoleWarn, getObjectValueByPath } from \"../util/index.mjs\"; // Types\n\nexport const LocaleAdapterSymbol = Symbol.for('vuetify:locale-adapter');\nexport const VuetifyLocaleSymbol = Symbol.for('vuetify:locale');\nexport function provideLocale(props) {\n  const adapter = inject(LocaleAdapterSymbol);\n  if (!adapter) throw new Error('[Vuetify] Could not find injected locale adapter');\n  return adapter.createScope(props);\n}\nexport function useLocale() {\n  const adapter = inject(LocaleAdapterSymbol);\n  if (!adapter) throw new Error('[Vuetify] Could not find injected locale adapter');\n  return adapter.getScope();\n}\n\nfunction isLocaleAdapter(x) {\n  return !!x && x.hasOwnProperty('getScope') && x.hasOwnProperty('createScope') && x.hasOwnProperty('createRoot');\n}\n\nexport function createLocale(app, options) {\n  const adapter = isLocaleAdapter(options) ? options : createDefaultLocaleAdapter(options);\n  const instance = adapter.createRoot(app);\n  app == null ? void 0 : app.provide(RtlSymbol, createRtl(instance, options));\n  return adapter;\n}\nconst LANG_PREFIX = '$vuetify.';\n\nconst replace = (str, params) => {\n  return str.replace(/\\{(\\d+)\\}/g, (match, index) => {\n    /* istanbul ignore next */\n    return String(params[+index]);\n  });\n};\n\nconst createTranslateFunction = (current, fallback, messages) => {\n  return function (key) {\n    for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      params[_key - 1] = arguments[_key];\n    }\n\n    if (!key.startsWith(LANG_PREFIX)) {\n      return replace(key, params);\n    }\n\n    const shortKey = key.replace(LANG_PREFIX, '');\n    const currentLocale = current.value && messages.value[current.value];\n    const fallbackLocale = fallback.value && messages.value[fallback.value];\n    let str = getObjectValueByPath(currentLocale, shortKey, null);\n\n    if (!str) {\n      consoleWarn(`Translation key \"${key}\" not found in \"${current.value}\", trying fallback locale`);\n      str = getObjectValueByPath(fallbackLocale, shortKey, null);\n    }\n\n    if (!str) {\n      consoleError(`Translation key \"${key}\" not found in fallback`);\n      str = key;\n    }\n\n    if (typeof str !== 'string') {\n      consoleError(`Translation key \"${key}\" has a non-string value`);\n      str = key;\n    }\n\n    return replace(str, params);\n  };\n};\n\nfunction createNumberFunction(current, fallback) {\n  return (value, options) => {\n    const numberFormat = new Intl.NumberFormat([current.value, fallback.value], options);\n    return numberFormat.format(value);\n  };\n}\n\nexport function createDefaultLocaleAdapter(options) {\n  const createScope = options => {\n    const current = ref(options.current);\n    const fallback = ref(options.fallback);\n    const messages = ref(options.messages);\n    return {\n      current,\n      fallback,\n      messages,\n      t: createTranslateFunction(current, fallback, messages),\n      n: createNumberFunction(current, fallback)\n    };\n  };\n\n  return {\n    createRoot: app => {\n      var _options$defaultLocal, _options$fallbackLoca, _options$messages;\n\n      const rootScope = createScope({\n        current: (_options$defaultLocal = options == null ? void 0 : options.defaultLocale) != null ? _options$defaultLocal : 'en',\n        fallback: (_options$fallbackLoca = options == null ? void 0 : options.fallbackLocale) != null ? _options$fallbackLoca : 'en',\n        messages: (_options$messages = options == null ? void 0 : options.messages) != null ? _options$messages : {\n          en\n        }\n      });\n      if (!app) throw new Error('[Vuetify] Could not find default app instance');\n      app.provide(VuetifyLocaleSymbol, rootScope);\n      return rootScope;\n    },\n    getScope: () => {\n      const currentScope = inject(VuetifyLocaleSymbol);\n      if (!currentScope) throw new Error('[Vuetify] Could not find injected locale instance');\n      return currentScope;\n    },\n    createScope: options => {\n      const currentScope = inject(VuetifyLocaleSymbol);\n      if (!currentScope) throw new Error('[Vuetify] Could not find injected locale instance');\n      const newScope = createScope({\n        current: computed(() => {\n          var _options$locale;\n\n          return (_options$locale = options == null ? void 0 : options.locale) != null ? _options$locale : currentScope.current.value;\n        }),\n        fallback: computed(() => {\n          var _options$locale2;\n\n          return (_options$locale2 = options == null ? void 0 : options.locale) != null ? _options$locale2 : currentScope.fallback.value;\n        }),\n        messages: computed(() => {\n          var _options$messages2;\n\n          return (_options$messages2 = options == null ? void 0 : options.messages) != null ? _options$messages2 : currentScope.messages.value;\n        })\n      });\n      provide(VuetifyLocaleSymbol, newScope);\n      return newScope;\n    }\n  };\n}","map":{"version":3,"mappings":"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","names":["en","createRtl","RtlSymbol","computed","inject","provide","ref","consoleError","consoleWarn","getObjectValueByPath","LocaleAdapterSymbol","Symbol","for","VuetifyLocaleSymbol","provideLocale","props","adapter","Error","createScope","useLocale","getScope","isLocaleAdapter","x","hasOwnProperty","createLocale","app","options","createDefaultLocaleAdapter","instance","createRoot","LANG_PREFIX","replace","str","params","match","index","String","createTranslateFunction","current","fallback","messages","key","arguments","startsWith","shortKey","currentLocale","value","fallbackLocale","createNumberFunction","numberFormat","Intl","NumberFormat","format","t","n","rootScope","defaultLocale","currentScope","newScope","locale"],"sources":["../../src/composables/locale.ts"],"sourcesContent":["// Locales\nimport en from '@/locale/en'\n\n// Composables\nimport { createRtl, RtlSymbol } from '@/composables/rtl'\n\n// Utilities\nimport { computed, inject, provide, ref } from 'vue'\nimport { consoleError, consoleWarn, getObjectValueByPath } from '@/util'\n\n// Types\nimport type { RtlOptions } from '@/composables/rtl'\nimport type { App, InjectionKey, Ref } from 'vue'\nimport type { MaybeRef } from '@/util'\n\nexport interface LocaleMessages {\n  [key: string]: LocaleMessages | string\n}\n\nexport interface LocaleOptions {\n  defaultLocale?: string\n  fallbackLocale?: string\n  messages?: LocaleMessages\n}\n\nexport interface LocaleProps {\n  locale?: string\n  fallbackLocale?: string\n  messages?: LocaleMessages\n}\n\nexport interface LocaleInstance {\n  current: Ref<string>\n  fallback: Ref<string>\n  messages: Ref<LocaleMessages>\n  t: (key: string, ...params: unknown[]) => string\n  n: (value: number) => string\n}\n\nexport interface LocaleAdapter {\n  createRoot: (app?: App) => LocaleInstance\n  getScope: () => LocaleInstance\n  createScope: (options?: LocaleProps) => LocaleInstance\n}\n\nexport const LocaleAdapterSymbol: InjectionKey<LocaleAdapter> = Symbol.for('vuetify:locale-adapter')\nexport const VuetifyLocaleSymbol: InjectionKey<LocaleInstance> = Symbol.for('vuetify:locale')\n\nexport function provideLocale (props?: LocaleProps) {\n  const adapter = inject(LocaleAdapterSymbol)\n\n  if (!adapter) throw new Error('[Vuetify] Could not find injected locale adapter')\n\n  return adapter.createScope(props)\n}\n\nexport function useLocale () {\n  const adapter = inject(LocaleAdapterSymbol)\n\n  if (!adapter) throw new Error('[Vuetify] Could not find injected locale adapter')\n\n  return adapter.getScope()\n}\n\nfunction isLocaleAdapter (x: any): x is LocaleAdapter {\n  return !!x && x.hasOwnProperty('getScope') && x.hasOwnProperty('createScope') && x.hasOwnProperty('createRoot')\n}\n\nexport function createLocale (\n  app: App,\n  options?: (LocaleOptions & RtlOptions) | (LocaleAdapter & RtlOptions),\n) {\n  const adapter = isLocaleAdapter(options) ? options : createDefaultLocaleAdapter(options)\n  const instance = adapter.createRoot(app)\n\n  app?.provide(RtlSymbol, createRtl(instance, options))\n\n  return adapter\n}\n\nconst LANG_PREFIX = '$vuetify.'\n\nconst replace = (str: string, params: unknown[]) => {\n  return str.replace(/\\{(\\d+)\\}/g, (match: string, index: string) => {\n    /* istanbul ignore next */\n    return String(params[+index])\n  })\n}\n\nconst createTranslateFunction = (\n  current: Ref<string>,\n  fallback: Ref<string>,\n  messages: Ref<LocaleMessages>,\n) => {\n  return (key: string, ...params: unknown[]) => {\n    if (!key.startsWith(LANG_PREFIX)) {\n      return replace(key, params)\n    }\n\n    const shortKey = key.replace(LANG_PREFIX, '')\n    const currentLocale = current.value && messages.value[current.value]\n    const fallbackLocale = fallback.value && messages.value[fallback.value]\n\n    let str: string = getObjectValueByPath(currentLocale, shortKey, null)\n\n    if (!str) {\n      consoleWarn(`Translation key \"${key}\" not found in \"${current.value}\", trying fallback locale`)\n      str = getObjectValueByPath(fallbackLocale, shortKey, null)\n    }\n\n    if (!str) {\n      consoleError(`Translation key \"${key}\" not found in fallback`)\n      str = key\n    }\n\n    if (typeof str !== 'string') {\n      consoleError(`Translation key \"${key}\" has a non-string value`)\n      str = key\n    }\n\n    return replace(str, params)\n  }\n}\n\nfunction createNumberFunction (current: Ref<string>, fallback: Ref<string>) {\n  return (value: number, options?: Intl.NumberFormatOptions) => {\n    const numberFormat = new Intl.NumberFormat([current.value, fallback.value], options)\n\n    return numberFormat.format(value)\n  }\n}\n\nexport function createDefaultLocaleAdapter (options?: LocaleOptions): LocaleAdapter {\n  const createScope = (options: {\n    current: MaybeRef<string>\n    fallback: MaybeRef<string>\n    messages: MaybeRef<LocaleMessages>\n  }) => {\n    const current = ref(options.current)\n    const fallback = ref(options.fallback)\n    const messages = ref(options.messages)\n\n    return {\n      current,\n      fallback,\n      messages,\n      t: createTranslateFunction(current, fallback, messages),\n      n: createNumberFunction(current, fallback),\n    }\n  }\n\n  return {\n    createRoot: app => {\n      const rootScope = createScope({\n        current: options?.defaultLocale ?? 'en',\n        fallback: options?.fallbackLocale ?? 'en',\n        messages: options?.messages ?? { en },\n      })\n\n      if (!app) throw new Error('[Vuetify] Could not find default app instance')\n\n      app.provide(VuetifyLocaleSymbol, rootScope)\n\n      return rootScope\n    },\n    getScope: () => {\n      const currentScope = inject(VuetifyLocaleSymbol)\n\n      if (!currentScope) throw new Error('[Vuetify] Could not find injected locale instance')\n\n      return currentScope\n    },\n    createScope: options => {\n      const currentScope = inject(VuetifyLocaleSymbol)\n\n      if (!currentScope) throw new Error('[Vuetify] Could not find injected locale instance')\n\n      const newScope = createScope({\n        current: computed(() => options?.locale ?? currentScope.current.value),\n        fallback: computed(() => options?.locale ?? currentScope.fallback.value),\n        messages: computed(() => options?.messages ?? currentScope.messages.value),\n      })\n\n      provide(VuetifyLocaleSymbol, newScope)\n\n      return newScope\n    },\n  }\n}\n"]},"metadata":{},"sourceType":"module"}